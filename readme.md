# 東方スクールオブフィッシュ

## 概要

「東方スクールオブフィッシュ」は、東方Projectのイントロクイズ/カルトクイズの練習を目的としたデスクトップアプリケーションです。

お手持ちの楽曲ファイルと、それに対応する情報を記載したCSVファイルを用意することで、楽曲の検索、再生、そして（将来的には）イントロクイズの演習が可能になります。

**【重要】**
このアプリケーションは現在開発中のバージョン（v0.2.1）です。
**特に「演習モード（クイズ機能）」はまだ実装されていません。** 現在は主に「聴取モード」での楽曲再生と検索・フィルタリング機能が利用可能です。今後のアップデートで機能を追加していく予定です。

## 主な機能（現在利用可能な機能）

*   **初期設定**:
    *   音楽ファイルが保存されているフォルダを指定できます。
    *   楽曲情報が記載されたCSVファイルを指定できます。
*   **聴取モード**:
    *   CSVファイルに基づいた楽曲リストを2列表示（楽曲名、キャラクター）で表示します。
    *   **検索機能**: 楽曲名またはキャラクター名でフリーワード検索ができます。
    *   **詳細絞り込み機能**（折りたたみ式）:
        *   **タイプ**: 初出、アレンジ、再録などをチェックボックスで複数選択
        *   **シリーズ区分**: 旧作、現行、西方等、黄昏などをチェックボックスで複数選択
        *   **場面**: ステージ・場面をラジオボタンで単一選択
    *   リストから選択した楽曲の詳細情報を箇条書きで表示します（タイプ、シリーズ区分、作品名、場面、キャラクター）。
    *   選択した楽曲を再生、一時停止、停止できます。
    *   音量を調整できます。
*   **設定**:
    *   アプリケーション起動後に、音楽フォルダやCSVファイルのパスを再設定できます。（設定の適用には、現状手動での再起動が必要です。）

## 必要なもの

このアプリケーションを利用するには、以下のものが必要です。

1.  **Node.js と npm**: アプリケーションを実行するために必要です。インストールされていない場合は、[Node.js 公式サイト](https://nodejs.org/)からダウンロードしてインストールしてください。npm は Node.js に付属しています。
2.  **東方Projectの楽曲ファイル**:
    *   MP3 (.mp3), WAV (.wav), FLAC (.flac) 形式のファイルに対応しています。
    *   これらの楽曲ファイルを1つのフォルダにまとめて保存しておいてください。作品ごとに分けるなど、フォルダ内にさらに子フォルダを作成することも可能です。
3.  **楽曲情報CSVファイル**:
    *   楽曲ファイルと対応する情報を記載したCSVファイルです。
    *   文字コードは **UTF-8** で保存してください。
    *   詳細は後述の「CSVファイルのフォーマット」を参照してください。

## セットアップと起動方法

### 1. アプリケーションの準備

*   このリポジトリ（プロジェクトファイル一式）をダウンロード、または Git を使ってクローンします。
    *   **ダウンロードの場合**: 右上にある「Code」ボタンをクリックし、「Download ZIP」を選択してダウンロード後、任意の場所に展開（解凍）してください。
    *   **Git の場合**: ターミナル（macOS や Linux）またはコマンドプロンプト（Windows）で以下のコマンドを実行します。
        ```bash
        git clone https://github.com/your-username/touhou-school-of-fish.git # (リポジトリのURLは適宜変更してください)
        ```

### 2. 必要なライブラリのインストール

1.  ターミナルまたはコマンドプロンプトを開きます。
2.  `cd` コマンドを使って、ダウンロードまたはクローンした **プロジェクトのフォルダに移動** します。
    ```bash
    cd path/to/touhou-school-of-fish # (実際のフォルダパスに置き換えてください)
    ```
3.  以下のコマンドを実行して、アプリケーションが必要とするライブラリ（依存パッケージ）をインストールします。インターネット接続が必要です。
    ```bash
    npm install
    ```
    `node_modules` というフォルダが作成されれば成功です。

### 3. アプリケーションの起動

1.  引き続き、ターミナルまたはコマンドプロンプトで、プロジェクトフォルダにいることを確認してください。
2.  以下のコマンドを実行します。
    ```bash
    npm start
    ```
3.  アプリケーションのウィンドウが表示されます。

### 4. 初回設定

1.  起動すると、まず「初期設定」画面が表示されます。
2.  「音楽ファイルが保存されているフォルダ」の右にある「選択」ボタンをクリックし、事前に準備した **楽曲ファイルが入っているフォルダ** を選択します。
3.  「楽曲情報が記録されているCSVファイル」の右にある「選択」ボタンをクリックし、事前に準備した **楽曲情報CSVファイル** を選択します。
4.  「アプリケーションを開始」ボタンがクリックできるようになります。ボタンをクリックしてください。（CSVファイル単体が選択されている場合でもクリック可能になりますが、その場合は楽曲を再生することはできません）
5.  メイン画面（聴取モード）が表示されれば、セットアップは完了です。

## CSVファイルのフォーマット

楽曲情報CSVファイルは、以下の形式で作成してください。**1行目は必ずヘッダー行** としてください。文字コードは **UTF-8** で保存してください。

```csv
ファイル名,タイトル,シリーズ区分,楽曲タイプ,登場作品,キャラクター,場面
th8/th8_1_stg,幻視の夜　～ Ghostly Eyes,現行,初出,東方永夜抄,,1道中
th8/th8_1_boss,蠢々秋月　～ Mooned Insect,現行,初出,東方永夜抄,リグル・ナイトバグ,1ボス
th8/th8_2_stg,夜雀の歌声　～ Night Bird,現行,初出,東方永夜抄,,2道中
th8/th8_2_boss,もう歌しか聞こえない,現行,初出,東方永夜抄,ミスティア・ローレライ,2ボス
```

*   **ファイル名**: 音楽フォルダに入っている楽曲ファイルの名前（拡張子不要）。相対パスを指定することが可能です。この名前で音楽ファイルと情報が紐付けられます。
*   **曲名**: 楽曲の正式名称。
*   **シリーズ区分**: 「旧作」「現行」「西方等」「黄昏」などを入力します（任意）。フィルターで使用されます。
*   **楽曲タイプ**: 「初出」「アレンジ」「再録」などを入力します（任意）。フィルターで使用されます。
*   **登場作品**: 楽曲が登場する原作名など（任意）。
*   **キャラクター**: 楽曲に関連するキャラクター名など（任意）。
*   **場面**: 楽曲が使用されたステージ、場面、キャラクターのテーマ区分（例：道中、ボス、エンディング、○○のテーマ）などを入力します（任意）。フィルターで使用されます。

**注意点**:

*   各項目はカンマ（`,`）で区切ってください。
*   項目内にカンマを含める場合は、項目全体をダブルクォーテーション（`"`）で囲むなど、標準的なCSVのルールに従ってください（ただし、現在のバージョンでは複雑なCSVの扱いに対応しきれていない可能性があります）。
*   ファイル名と曲名は必須ですが、他の項目は空でも構いません。
*   CSVファイルに記載されていても、対応する音楽ファイルが指定フォルダ内に存在しない場合、その楽曲はリストに表示されません。

## 今後の開発予定

*   **演習モード（クイズ機能）の実装**:
    *   イントロ再生
    *   回答入力（テキスト、ボタン選択など）
    *   正誤判定
    *   結果表示
    *   出題範囲の絞り込み機能強化
*   **CSVパースライブラリの導入**: より安定したCSVファイルの読み込み（PapaParse の利用）。
*   **音声再生ライブラリの活用**: より高度な音声制御（Howler.js の利用）。
*   **設定の永続化**: アプリケーションを閉じても設定が保存されるようにします。
*   **検索・フィルタリング機能の拡張**: より柔軟な条件指定や保存機能。
*   **楽曲リスト表示の改善**: ソート機能や表示列のカスタマイズ。
*   **ビルド設定の最適化**: 配布用のファイルサイズ削減など。

## v0.2.1での主な更新内容

*   **演習モード絞り込み機能の実装**: 聴取モードと同様の詳細絞り込み機能を演習モードに追加
*   **作品名フィルターの追加**: 聴取・演習モード双方で作品名による絞り込みが可能
*   **リアルタイム楽曲数表示**: 絞り込み条件に応じた楽曲数と再生可能数の表示
*   **楽曲リストヘッダーの改善**: 表示楽曲がない場合でもヘッダーを常時表示し、件数表示を追加
*   **UI/UX の向上**: クイズ開始ボタンの適切な無効化処理とユーザビリティ改善

## v0.2.0での主な更新内容

*   **検索機能の強化**: 楽曲名とキャラクター名での絞り込み検索
*   **詳細フィルタリング機能**: タイプ、シリーズ区分、場面での多様な絞り込み
*   **楽曲リスト表示の改善**: 2列表示（楽曲名、キャラクター）と固定ヘッダー
*   **楽曲詳細表示の改善**: 箇条書き形式での情報表示
*   **UI/UX の向上**: 折りたたみ式フィルターとより直感的な操作

## ライセンス

このソフトウェアは [MITライセンス](LICENSE) の下で公開されています。